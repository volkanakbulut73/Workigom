# Integration Flow Diagram

## ğŸ“ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND                                 â”‚
â”‚                    (React + TypeScript)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     App.tsx                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚          <AuthProvider>                          â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    (Authentication Context & State)              â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                        â–¼                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚          <AdminPanel>                            â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    â”‚   Sidebar Navigation                â”‚       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    â”‚  activePage === 'notifications'   â”‚       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    â”‚         â†“                           â”‚       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    â”‚   <SendNotification />              â”‚       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            src/lib/api.ts                                 â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  axios.create({                                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚    baseURL: VITE_BACKEND_URL/api                   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  })                                                  â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  Request Interceptor                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â†’ Add: Authorization: Bearer <token>              â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  Response Interceptor                               â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â†’ Handle 401/403/500 errors                       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â†’ Show toast notifications                         â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  API Functions:                                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ authAPI.login()                                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ authAPI.getCurrentUser()                         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ adminAPI.sendNotification()                      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ adminAPI.getUsers()                              â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ HTTP Requests
                                â”‚ (with Bearer Token)
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND                                  â”‚
â”‚                    (Node.js + Express)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   Express App                             â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  CORS Middleware                                    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â†’ Allow frontend origin                            â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                        â–¼                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  Routes:                                            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  /api/auth/*         â†’ auth.routes.ts             â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  /api/admin/*        â†’ admin.routes.ts            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  /api/notifications/* â†’ notification.routes.ts    â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         /api/auth/login (POST)                            â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  1. auth.controller.ts â†’ login()                         â”‚  â”‚
â”‚  â”‚     â”œâ”€ Find user by email                                 â”‚  â”‚
â”‚  â”‚     â”œâ”€ Compare password (bcrypt)                          â”‚  â”‚
â”‚  â”‚     â”œâ”€ Generate JWT token                                 â”‚  â”‚
â”‚  â”‚     â””â”€ Return: { user, token, refreshToken }             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    /api/admin/send-notification (POST)                    â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Middleware Chain:                                         â”‚  â”‚
â”‚  â”‚  1. authenticate                                           â”‚  â”‚
â”‚  â”‚     â”œâ”€ Extract Bearer token from header                   â”‚  â”‚
â”‚  â”‚     â”œâ”€ Verify JWT signature                               â”‚  â”‚
â”‚  â”‚     â”œâ”€ Find user in database                              â”‚  â”‚
â”‚  â”‚     â””â”€ Attach user to req.user                            â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  2. requireAdmin                                           â”‚  â”‚
â”‚  â”‚     â”œâ”€ Check req.user.role === 'ADMIN'                    â”‚  â”‚
â”‚  â”‚     â””â”€ Return 403 if not admin                            â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  3. sendNotificationValidation                             â”‚  â”‚
â”‚  â”‚     â”œâ”€ Validate request body                              â”‚  â”‚
â”‚  â”‚     â””â”€ Check required fields                              â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  4. adminNotification.controller.ts â†’ sendNotification()  â”‚  â”‚
â”‚  â”‚     â”œâ”€ Find target users based on targetType             â”‚  â”‚
â”‚  â”‚     â”œâ”€ Create notifications in bulk                       â”‚  â”‚
â”‚  â”‚     â””â”€ Return success with count                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Prisma ORM                                   â”‚  â”‚
â”‚  â”‚                  â–¼                                         â”‚  â”‚
â”‚  â”‚         PostgreSQL Database                               â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Tables:                                                   â”‚  â”‚
â”‚  â”‚  â€¢ User (id, email, password, role, ...)                 â”‚  â”‚
â”‚  â”‚  â€¢ Notification (id, userId, title, content, ...)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Authentication Flow (Detailed)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ADMIN LOGIN FLOW                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. User opens Admin Panel
   â”‚
   â”œâ”€â–¶ AdminLogin component renders
   â”‚
2. User enters credentials
   â”‚   Email: admin@workigom.com
   â”‚   Password: ********
   â”‚
3. Clicks "Sign In" button
   â”‚
   â””â”€â–¶ AdminLogin calls: useAuth().login(email, password)
       â”‚
       â”œâ”€â–¶ AuthContext.login() is called
       â”‚   â”‚
       â”‚   â””â”€â–¶ authAPI.login(email, password) 
       â”‚       â”‚
       â”‚       â””â”€â–¶ axios.post('/api/auth/login', { email, password })
       â”‚           â”‚
       â”‚           â””â”€â–¶ BACKEND: auth.controller.login()
       â”‚               â”‚
       â”‚               â”œâ”€ Find user in database
       â”‚               â”œâ”€ Verify password with bcrypt
       â”‚               â”œâ”€ Generate JWT token
       â”‚               â””â”€ Return: {
       â”‚                     success: true,
       â”‚                     data: {
       â”‚                       user: { id, email, name, role: "ADMIN" },
       â”‚                       token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
       â”‚                       refreshToken: "..."
       â”‚                     }
       â”‚                   }
       â”‚
       â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Response received â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                               â”‚
       â”œâ”€ setAuthToken(token)                         â”‚
       â”‚  â””â”€â–¶ localStorage.setItem('authToken', token)â”‚
       â”‚                                               â”‚
       â”œâ”€ setUser(user)                               â”‚
       â”‚  â””â”€â–¶ Update React state                      â”‚
       â”‚                                               â”‚
       â”œâ”€ localStorage.setItem('currentUser', JSON.stringify(user))
       â”‚                                               â”‚
       â””â”€ toast.success('âœ… Login successful!')       â”‚
          â”‚                                            â”‚
          â””â”€â–¶ User redirected to Admin Panel          â”‚
              â”‚                                        â”‚
              â””â”€â–¶ Can now send notifications âœ…       â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SEND NOTIFICATION FLOW                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Admin navigates to "Send Notification" page
   â”‚
   â”œâ”€â–¶ SendNotification component renders
   â”‚
2. Component checks authentication
   â”‚
   â”œâ”€â–¶ useAuth() â†’ { isAuthenticated, isAdmin }
   â”‚
   â”œâ”€ if (!isAuthenticated || !isAdmin)
   â”‚  â””â”€â–¶ Show "Access Denied" message âŒ
   â”‚
3. Admin fills the form
   â”‚   Target: "All Users"
   â”‚   Title: "System Maintenance"
   â”‚   Message: "The system will be down for maintenance..."
   â”‚
4. Admin clicks "Send Notification"
   â”‚
   â””â”€â–¶ handleSend() is called
       â”‚
       â”œâ”€â–¶ Validate form fields
       â”‚
       â””â”€â–¶ adminAPI.sendNotification(payload)
           â”‚
           â””â”€â–¶ axios.post('/api/admin/send-notification', payload)
               â”‚
               â”œâ”€ Request Interceptor adds:
               â”‚  Authorization: Bearer <token from localStorage>
               â”‚
               â””â”€â–¶ BACKEND receives request
                   â”‚
                   â”œâ”€â–¶ authenticate middleware
                   â”‚   â”œâ”€ Extract token from Authorization header
                   â”‚   â”œâ”€ Verify JWT signature
                   â”‚   â”œâ”€ Find user in database
                   â”‚   â””â”€ Attach user to req.user âœ…
                   â”‚
                   â”œâ”€â–¶ requireAdmin middleware
                   â”‚   â”œâ”€ Check req.user.role === 'ADMIN'
                   â”‚   â””â”€ Continue if admin âœ…
                   â”‚
                   â”œâ”€â–¶ sendNotificationValidation
                   â”‚   â””â”€ Validate request body âœ…
                   â”‚
                   â””â”€â–¶ adminNotification.controller.sendNotification()
                       â”‚
                       â”œâ”€ Query users based on targetType
                       â”‚  (ALL, ALL_INDIVIDUALS, ALL_COMPANIES, etc.)
                       â”‚
                       â”œâ”€ Create notification records
                       â”‚  await prisma.notification.createMany({
                       â”‚    data: notifications
                       â”‚  })
                       â”‚
                       â””â”€ Return: {
                             success: true,
                             data: {
                               count: 25,
                               targetType: "ALL"
                             },
                             message: "Notifications sent to 25 users"
                           }
                   
                   â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚                             â”‚
                   â””â”€â–¶ Response Interceptor      â”‚
                       â”‚                         â”‚
                       â””â”€ toast.success('âœ… Notification sent!')
                          â”‚
                          â””â”€â–¶ Form cleared âœ…    â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TOKEN VALIDATION FLOW                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Every API Request:
â”‚
â”œâ”€â–¶ Request Interceptor (frontend)
â”‚   â”‚
â”‚   â”œâ”€ Get token: localStorage.getItem('authToken')
â”‚   â””â”€ Add header: Authorization: Bearer <token>
â”‚
â””â”€â–¶ authenticate Middleware (backend)
    â”‚
    â”œâ”€ Check Authorization header exists
    â”‚  if (!authHeader) â†’ 401 Unauthorized âŒ
    â”‚
    â”œâ”€ Extract token (remove "Bearer " prefix)
    â”‚
    â”œâ”€ Verify JWT signature
    â”‚  jwt.verify(token, JWT_SECRET)
    â”‚  if (invalid) â†’ 401 Invalid token âŒ
    â”‚
    â”œâ”€ Check expiration
    â”‚  if (expired) â†’ 401 Token expired âŒ
    â”‚
    â”œâ”€ Find user in database
    â”‚  const user = await prisma.user.findUnique({ where: { id: decoded.userId }})
    â”‚  if (!user) â†’ 401 User not found âŒ
    â”‚
    â””â”€ Attach user to request
       req.user = user âœ…
       next() â†’ Continue to controller


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ERROR HANDLING FLOW                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Backend Error â†’ Response
â”‚
â””â”€â–¶ Response Interceptor (frontend)
    â”‚
    â”œâ”€ error.response.status === 401
    â”‚  â”œâ”€ Remove token from localStorage
    â”‚  â”œâ”€ Clear currentUser
    â”‚  â””â”€ toast.error('âŒ Invalid or expired token')
    â”‚
    â”œâ”€ error.response.status === 403
    â”‚  â””â”€ toast.error('âŒ Admin access required')
    â”‚
    â”œâ”€ error.response.status === 404
    â”‚  â””â”€ toast.error('âŒ Resource not found')
    â”‚
    â”œâ”€ error.response.status === 500
    â”‚  â””â”€ toast.error('âŒ Server error')
    â”‚
    â””â”€ error.request (no response)
       â””â”€ toast.error('âŒ Network error. Check backend URL')
```

## ğŸ” Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY ARCHITECTURE                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: HTTPS Encryption
   â””â”€â–¶ All communication encrypted in transit âœ…

Layer 2: CORS Protection
   â””â”€â–¶ Only allowed origins can access API âœ…

Layer 3: JWT Authentication
   â”œâ”€ Token signed with secret key
   â”œâ”€ Token includes user ID and role
   â”œâ”€ Token has expiration time
   â””â”€ Token verified on every request âœ…

Layer 4: Role-Based Access Control
   â”œâ”€ authenticate: Verify valid token
   â””â”€ requireAdmin: Verify ADMIN role âœ…

Layer 5: Password Security
   â”œâ”€ Passwords hashed with bcrypt
   â””â”€ Salt rounds: 10 âœ…

Layer 6: Input Validation
   â”œâ”€ Request body validation
   â”œâ”€ SQL injection prevention (Prisma ORM)
   â””â”€ XSS prevention (sanitization) âœ…
```

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser    â”‚         â”‚   Frontend   â”‚         â”‚   Backend    â”‚
â”‚  (DevTools)  â”‚         â”‚  (React App) â”‚         â”‚  (Express)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚  1. Admin opens page   â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚  2. Check localStorage â”‚                        â”‚
       â”‚     authToken exists?  â”‚                        â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚  3. If token exists,   â”‚                        â”‚
       â”‚     verify with backendâ”‚  GET /api/auth/me      â”‚
       â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚  Token valid?          â”‚
       â”‚                        â”‚  User is ADMIN?        â”‚
       â”‚                        â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                        â”‚  { user: {...} } âœ…    â”‚
       â”‚                        â”‚                        â”‚
       â”‚  4. Render Admin Panel â”‚                        â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚  5. Navigate to Send   â”‚                        â”‚
       â”‚     Notification       â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚  6. Render form        â”‚                        â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚  7. Fill and submit    â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚  POST /api/admin/      â”‚
       â”‚                        â”‚  send-notification     â”‚
       â”‚                        â”‚  + Authorization headerâ”‚
       â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚  1. Validate token     â”‚
       â”‚                        â”‚  2. Check admin role   â”‚
       â”‚                        â”‚  3. Validate data      â”‚
       â”‚                        â”‚  4. Create notificationsâ”‚
       â”‚                        â”‚  5. Save to DB         â”‚
       â”‚                        â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                        â”‚  { success, count } âœ… â”‚
       â”‚                        â”‚                        â”‚
       â”‚  8. Show success toast â”‚                        â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚  âœ… Notification sent! â”‚                        â”‚
       â”‚                        â”‚                        â”‚
```

## ğŸ—„ï¸ Database Schema

```sql
-- User Table
CREATE TABLE "User" (
  id            TEXT PRIMARY KEY,
  email         TEXT UNIQUE NOT NULL,
  password      TEXT NOT NULL,
  name          TEXT NOT NULL,
  phone         TEXT,
  role          "UserRole" NOT NULL,  -- ADMIN | INDIVIDUAL | CORPORATE
  avatar        TEXT,
  isVerified    BOOLEAN DEFAULT false,
  verifyToken   TEXT,
  resetToken    TEXT,
  resetTokenExp TIMESTAMP,
  createdAt     TIMESTAMP DEFAULT NOW(),
  updatedAt     TIMESTAMP DEFAULT NOW()
);

-- Notification Table
CREATE TABLE "Notification" (
  id        TEXT PRIMARY KEY,
  userId    TEXT NOT NULL,
  type      "NotificationType" NOT NULL,  -- SYSTEM | JOB_MATCH | etc.
  title     TEXT NOT NULL,
  content   TEXT NOT NULL,
  link      TEXT,
  isRead    BOOLEAN DEFAULT false,
  createdAt TIMESTAMP DEFAULT NOW(),
  
  FOREIGN KEY (userId) REFERENCES "User"(id)
);

-- Indexes for performance
CREATE INDEX idx_notification_user ON "Notification"(userId);
CREATE INDEX idx_notification_read ON "Notification"(isRead);
CREATE INDEX idx_user_email ON "User"(email);
CREATE INDEX idx_user_role ON "User"(role);
```

## ğŸš€ Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          PRODUCTION                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Frontend (Vercel)
  â”œâ”€ URL: https://workigom.vercel.app
  â”œâ”€ Environment: VITE_BACKEND_URL=https://workigom-backend.onrender.com
  â”œâ”€ Auto-deploy on: git push to main
  â””â”€ Build: npm run build â†’ Static files

Backend (Render)
  â”œâ”€ URL: https://workigom-backend.onrender.com
  â”œâ”€ Environment: DATABASE_URL, JWT_SECRET, CORS_ORIGIN
  â”œâ”€ Auto-deploy on: git push to main
  â””â”€ Runtime: Node.js + Express

Database (Render PostgreSQL)
  â”œâ”€ URL: postgresql://user:pass@host:port/db
  â”œâ”€ Managed service with automatic backups
  â””â”€ Connected via Prisma ORM

Communication:
  Frontend â”€[HTTPS]â”€â–¶ Backend â”€[PostgreSQL]â”€â–¶ Database
```

---

**Created**: November 2, 2025  
**Author**: DeepAgent AI  
**Version**: 1.0
